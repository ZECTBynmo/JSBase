<!doctype html>
<html>
	<head>
		<!-- ------------------------------------------------------------------------------------------------ -->
		<!-- Scripts -->	
		<!-- ------------------------------------------------------------------------------------------------ -->
		<script src="jquery-1.7.1.min.js" type="text/javascript"></script>
		<script src="LongPoll.js" type="text/javascript"></script>
		<script>
			var longPoll = new LongPoll();
			
			var eventCallback = {
				eventName: "newChat",
				callback: displayResults
			}
			longPoll.addEventCallback( eventCallback );
			$(document).ready(function() {
				// Start up the event loop
				longPoll.eventLoop();
			});
		
			function displayResults( results ) {
				$('#resultList').empty();
				
				for( var iResult in results ) {
					$("#resultList").append('<li>' + results[iResult] +'</li><br />');
				}
			} // end displayResults()
			
			function refreshResults() {
				var newChat = {
					text: "test",
					userInfo: { name: "testName" },
					time: new Date()
				}
				jQuery.get("/newChat", newChat, function (data, status) {
					if (status != "success") return;
					//displayResults( data );
				}, "json");
			} // end refreshResults()
		</script>
	</head>
	<body>
		<h1 align='center'>Press the button to send your request</h1>
		
		<ol id="resultList"></ol>
		<input id="showResultsButton" type="button" onClick="refreshResults();" value="Make Request"/>
	</body>	
</html>